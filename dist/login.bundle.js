(()=>{"use strict";function e(e){return"string"!=typeof e||0===e.trim().length}window.onload=function(){null!=function(){var e=localStorage.getItem("user"),o=localStorage.getItem("authToken");if(!e||!o)return localStorage.removeItem("user"),localStorage.removeItem("authToken"),null;try{return JSON.parse(e)}catch(e){return localStorage.removeItem("user"),localStorage.removeItem("authToken"),null}}()&&(console.log("Redirecting to account-overview because the user is logged in."),window.location.replace("account-overview.html")),$("#login-btn").on("click",(function(o){console.log("submit"),o.preventDefault();var r={};return $("#email-form").serializeArray().forEach((function(e){var o=e.name,t=e.value;"Email"===o?r.email=(t||"").trim():"Password"===o&&(r.password=t)})),e(r.email)?($("#error-message").text("Please fill out the email."),void $("#error-message").css("display","block")):e(r.password)?($("#error-message").text("Please fill out the password."),void $("#error-message").css("display","block")):(console.log("sending: %O",r),void $.ajax({method:"POST",url:"".concat(apiHost,"/api/v1/login"),data:JSON.stringify(r),dataType:"json",contentType:"application/json",error:function(e){var o=(e.responseJSON||{}).code;console.log("failure code="+o),"unauthorized"===o?($("#error-message").text("Username does not exist or the credentials do not match."),$("#error-message").css("display","block")):($("#error-message").text("There was a problem while logging you in. code=".concat(o)),$("#error-message").css("display","block"))}}).done((function(e){var o=e.token,r=e.user;console.log("login response: %O",e),localStorage.setItem("authToken",o),localStorage.setItem("user",JSON.stringify(r)),window.location.replace("account-overview.html")})))}))}})();